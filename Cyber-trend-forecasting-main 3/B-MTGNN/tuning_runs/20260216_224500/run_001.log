CUDA not available, using CPU
Loading data from /Users/samrobert/Documents/GitHub/Exchangeprediction/Cyber-trend-forecasting-main 3/B-MTGNN/data/sm_data.csv...
Data loaded and converted to numeric successfully.
Graph loaded with 1 attacks...
33 columns loaded
Adjacency created...
train X: torch.Size([131, 24, 33])
train Y: torch.Size([131, 1, 33])
valid X: torch.Size([11, 24, 33])
valid Y: torch.Size([11, 1, 33])
test X: torch.Size([11, 24, 33])
test Y: torch.Size([11, 1, 33])
test window: torch.Size([36, 33])
length of training set= 131
length of validation set= 11
length of testing set= 11
valid= 168
Auto-detected num_nodes: 33
Namespace(data='/Users/samrobert/Documents/GitHub/Exchangeprediction/Cyber-trend-forecasting-main 3/B-MTGNN/data/sm_data.csv', log_interval=2000, save='/Users/samrobert/Documents/GitHub/Exchangeprediction/Cyber-trend-forecasting-main 3/B-MTGNN/tuning_runs/20260216_224500/checkpoints/model_001.pt', optim='adam', L1Loss=True, normalize=2, device='cuda:1', gcn_true=False, buildA_true=False, use_graph=0, gcn_depth=1, num_nodes=33, dropout=0.1, subgraph_size=40, node_dim=30, dilation_exponential=2, conv_channels=16, residual_channels=128, skip_channels=256, end_channels=1024, in_dim=1, seq_in_len=24, seq_out_len=1, horizon=1, layers=2, batch_size=4, lr=0.0002, weight_decay=1e-05, clip=10, propalpha=0.6, tanhalpha=0.1, epochs=1, num_split=1, step_size=100, ss_prob=0.2, train_ratio=0.8666666667, valid_ratio=0.0666666667, focus_targets=0, focus_nodes='jp_fx,kr_fx,us_ret', focus_weight=0.35, rse_targets='Us_Trade Weighted Dollar Index_Testing.txt,Jp_fx_Testing.txt,Kr_fx_Testing.txt', plot_focus_only=0, debug_eval=0, rollout_mode='teacher_forced', seed=123, plot=0, clean_cache=0, autotune_mode=1)
The recpetive field size is 19
Number of model parameters is 611649
begin training
Experiment: 1
Iter: 0
epoch: 1
hp= [1, 0.0002, 16, 128, 256, 1024, 40, 0.1, 2, 30, 0.6, 0.1, 2, 1]
best sum= 10000000
best rrse= 10000000
best rrae= 10000000
best corr= -10000000
best smape= 10000000
best objective= 10000000
best hps= []
best test rse= 10000000
best test corr= -10000000
[Target-Weighted Loss] disabled (uniform weight for overall RSE optimization)
iter:  0 | loss: 1.412
iter:  1 | loss: 1.172
iter:  2 | loss: 1.395
iter:  3 | loss: 1.383
iter:  4 | loss: 1.330
iter:  5 | loss: 1.278
iter:  6 | loss: 1.261
iter:  7 | loss: 1.380
iter:  8 | loss: 1.258
iter:  9 | loss: 1.420
iter: 10 | loss: 1.085
iter: 11 | loss: 1.342
iter: 12 | loss: 1.250
iter: 13 | loss: 1.240
iter: 14 | loss: 1.287
iter: 15 | loss: 1.276
iter: 16 | loss: 1.396
iter: 17 | loss: 1.181
iter: 18 | loss: 1.377
iter: 19 | loss: 1.342
iter: 20 | loss: 1.105
iter: 21 | loss: 1.234
iter: 22 | loss: 1.152
iter: 23 | loss: 1.434
iter: 24 | loss: 1.169
iter: 25 | loss: 1.317
iter: 26 | loss: 1.416
iter: 27 | loss: 1.246
iter: 28 | loss: 1.237
iter: 29 | loss: 1.157
iter: 30 | loss: 1.387
iter: 31 | loss: 1.212
iter: 32 | loss: 1.058
testing r= 5
rrse= 81.20378493333916 / 34.875950297872706
| end of epoch   1 | time:  2.21s | train_loss 1.2800 | valid rse 2.3284 | valid rae 2.8349 | valid corr  0.0455 | valid smape  0.3126 | focus_rrse 2.2887 | obj 2.3145
testing r= 5
rrse= 201.57821644153418 / 87.05324564957357
********************************************************************************************************
test rse 2.3156 | test rae 2.5741 | test corr 0.0875| test smape 0.2625 | test focus_rrse 1.4544
********************************************************************************************************
best val loss= 5.117761048736622
best hps= [1, 0.0002, 16, 128, 256, 1024, 40, 0.1, 2, 30, 0.6, 0.1, 2, 1]
testing r= 5
rrse= 81.14799486316652 / 34.875950297872706
testing r= 5
rrse= 201.43106179596532 / 87.05324564957357
********************************************************************************************************
final test rse 2.3139 | test rae 2.5710 | test corr 0.0863 | test smape 0.2625
********************************************************************************************************



1 run average



valid	rse	rae
mean	2.3268	2.8528
std	0.0000	0.0000



test	rse	rae
mean	2.3139	2.5710
std	0.0000	0.0000
